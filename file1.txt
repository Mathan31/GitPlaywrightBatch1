New implementation done by Arun